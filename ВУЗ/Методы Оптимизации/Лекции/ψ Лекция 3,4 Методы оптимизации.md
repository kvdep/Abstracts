Симплекс-метод 
(n-мерный многогранник)

этапы
1.Подготовительный этап
1.1 Привести ЗЛП к каноническому виду
1.2 Разделить переменные на базисные и свободные
$\begin{cases} x_1 + ... +a_{1,m+1}x_{m+1} + ... + a_{1,n}x_n = b_1 \\ x_2 + ... + a_{2,m+1}x_{m+1} + ...a_{2,n}x_n=b_2 \\ x_m + ... + a_{m,m+1}x_{m+1} + ...a_{m,n}x_n=b_m\end{cases}$
$x_1, ... x_m$ - БП
$x_{m+1}, ... x_n$ - СЧ
$b_i \geq 0, i = 1,...,m$
$x_{баз} = (b_1,b_2,...,b_m,0,...,0)$
Необходимые и достаточные условия опорного базиса:
$x_{баз} \neq 0$ уд. $\overline{A}x=b$ 
1.3 $z = f(x)$ БП и $z + C_{m+1}x_{m+1} + C_{m+2}x_{m+2} + ... + C_{n}x_{n} = C_0$
1.4 Заполняем симплексную таблицу:
$\begin{array}{cccccccc} \text{БП} & \text{СЧ} & x_1 & x_2 & \dots & x_m & \dots & x_n \\ x_1 & b_1 & 1 & 0 & \dots & 0 & \dots & a_{1n} \\ \vdots & \vdots & \vdots & \vdots & \ddots & \vdots & \ddots & \vdots \\ x_m & b_m & 0 & 0 & \dots & 1 & \dots & a_{mn} \\ z & C_0 & 0 & 0 & 0 & C_{m+1} & \dots & C_n \end{array}$
$C_{m+1},...,C_n$ - оценки

2.Алгоритм с-м
1)$C_j \geq 0$, $j$ - $m, ..., n$, то $x_{баз}=x^*$
2)$\exists C_{p} < 0,$ но $\overlap{\exists}a_{rp}>0 $
! (нужно дописать с записи)
Пример
$z = 2x_1-x_2+3x_3-2x_4+x_5 \to max$ 
$\begin{cases} -x_1 + x_2 + x_3 = 1 \\ x_1 - x_2 + x_4 = 1 \\ x_1 + x_2 + x_5 = 2 \\ x\geq 0\end{cases}$ 
$z = 2x_1 - x_2 + 3(1 + x_1 - x_2) - 2(1-x_1 + x_2) + 2 - x_1 - x_2 = 3 + 6x_1 - 7x_2$ -> при увеличении $x_1$ увеличивается целевая z
$z - 6x_1 + 7x_2=3$
$\begin{array}{ccccccc} \text{БП} & \text{СЧ} & x_1 & x_2 & x_3 & x_4 & x_5 \\ x_3 & 1 & -1 & 1 & 1 & 0 & 0 \\ x_4 & 1 & 1 & -1 & 0 & 1 & 0 \\ x_5 & 2 & 1 & 1 & 0 & 0 & 1 \\ z & 3 & -6 & 7 & 0 & 0 & 0 \end{array}$
$x^1_{баз} = (0,0,1,1,2)$
выберем -6 для рассмотрения как наименьшее отрицательное значение в последней строчке таблицы
$min\{\frac{1}{1},\frac{2}{1}\} = 1$   
$\begin{array}{ccccccc} \text{БП} & \text{СЧ} & x_1 & x_2 & x_3 & x_4 & x_5 \\ x_3 & 1 & -1 & 1 & 1 & 0 & 0 \\ x_4 & 1 & 1 & -1 & 0 & 1 & 0 \\ x_5 & 2 & 1 & 1 & 0 & 0 & 1 \\ \hline z & 3 & -6 & 7 & 0 & 0 & 0 \\ \hline x_3 & 2 & 0 & 0 & 1 & 1 & 0 \\ x_1 & 1 & 1 & -1 & 0 & 1 & 0 \\ x_5 & 1 & 0 & 2 & 0 & -1 & 1 \\ \hline z & 9 & 0 & 1 & 0 & 6 & 0 \\ \hline \end{array}$
$x^* = (1,0,2,0,1),z^*=9$ ; * - оптим

$x_2=0$
$\begin{cases} -x_1 + x_3 = 1 \\ x_1 + x_4 = 1 \\ x_1 + x_5 = 2\end{cases}$  $\rightarrow$ $\begin{cases}x_3 = 1+x_1 \geq 0 \rightarrow x_1 \geq -1 \\ x_4 = 1-x_1 \geq 0 \rightarrow x_1 \leq \frac{1}{1} \\ x_5 = 2-x_1 \geq 0 \rightarrow x_1 \leq \frac{2}{1}\end{cases}$     
$X = \begin{cases}a_{11}x_1 + ... + a_m x_n = b_1 \\...\\ a_{m1}x_1 + ... + a_{mn}x_n\end{cases}$ 
Метод искусственного базиса:
$y = (y_1, ..., y_m)$, $b_i \geq 0, i=1,...,m$
$y \geq 0$
$F(y) = y_1 + ... + y_m \to min$ 
1)$F_{min} > 0,$ то исходная задача не имеет решений в неотрицательных x
2)$F_{min}=0,$ то исходная задача имеет решения

$z = x_1 + 4x_4 + 2x_2 + x_5 \to min$
$\begin{cases}3x_1 - 5x_2 + x_3 + 2x_4 = 1 \\ 2x_1 - 2x_2 + x_4 - x_5 = -4 \\ x_1 - 3x_2 + 2x_4 - x_5 = -5 \\ x \geq 0\end{cases}$ 

$\begin{cases}3x_1 - 5x_2 + x_3 + 2x_4 = 1 \\ 2x_1 - 2x_2 + x_4 - x_5 = -4 \\ x_1 - 3x_2 + 2x_4 - x_5 = -5 \\ x \geq 0\end{cases}$ $\rightarrow$ $\begin{cases}3x_1 - 5x_2 + x_3 + 2x_4 = 1 \\ -2x_1 + 2x_2 - x_4 + x_5 = 4 \\ -x_1 + 3x_2 - 2x_4 + x_5 = 5 \\ x \geq 0\end{cases}$ 
$F = y_1 + y_2 = 9 + 3x_1 - 5x_2 + 3x_4 - 2x_5$ 
$F - 3x_1 + 5x_2 - 3x_4 - 2x_5 = 9$
$\begin{array}{|c|c|ccccccc|} \hline \text{БП} & \text{СЧ} & x_1 & x_2 & x_3 & x_4 & x_5 & y_1 & y_2 \\ \hline x_3 & 1 & 3 & -5 & 1 & 2 & 0 & 0 & 0 \\ y_1 & 4 & -2 & 2 & 0 & -1 & 1 & 1 & 0 \\ y_2 & 5 & -1 & 3 & 0 & -2 & 1 & 0 & 1 \\ \hline z & 0 & -1 & -2 & 0 & -4 & -1 & 0 & 0 \\ \hline F & 9 & -3 & 5 & 0 & -3 & -2 & 0 & 0 \\ \hline \end{array}$
$min\{\frac{4}{2},\frac{5}{3}\}=\frac{5}{3}$ 

(номер будет на семинаре)


Теория Двойственности 
$f(x)\to max,$
$X = \{x|x\in P, g_i(x) \geq 0, i=1,...,m\}$
$L = (x,\lambda) = f(x) + \sum \lambda_i g_i$
эквивалентно
($\underset{x\in P}{max}\underset{\lambda \geq 0}{inf}L(x,\lambda)$)
Двойственной задачей к исходной задаче называется 
$\underset{\lambda \geq 0}{min} \text{ }\underset{x\in P}{sup}L(x,\lambda)$
$L(x,\lambda) = cx + \lambda(b-Ax) = (cx - \lambda A x + \lambda b) \underset{\lambda=y}{=} ((c-A^Ty)x+by)$
$\underset{\lambda \geq 0}{min}\underset{x\geq 0}{sup}(cx + \lambda (b-Ax)) = \underset{y\geq 0 }{min}\underset{x\geq0}{sup}((c-A^Ty)x+by) = \underset{y\geq0}{min}\text{ }by$  
ЗЛП:
$\begin{cases}cx\to max \\ Ax\leq b, \\ x\geq0\end{cases}$
Двойственная задача:
$\begin{cases}by \to min \\ A^Ty\geq C \\ y\geq0\end{cases}$

$\begin{cases}cx\to max \\ Ax= b, \\ x\geq0\end{cases}$
Двойственная задача:
$\begin{cases}by\to min \\ Ay\geq C\end{cases}$


Т(основное направление двойственной задачи): $\forall x\in X, \forall y \in Y, f(x)\leq g(y) (cx\leq by)$  
Следствие: Если $\exists x^*\in X, y^*\in Y, f(x^*) = g(y^*),$ то $x^*$ и $y^*$ - решения задачи двойственной пары
Т1(первая.т.двойственности.): Двойственные задачи ЛП либо обе имеют решения, причем $cx^*=by^*$
Т2(вторая теорема двойственности): Если $x^*$ и $y^*$ - решения задачи двойственности, то 
$y_i^*()$

Пример:
$f(x)=-4x_1+5x_2+8x_3\to max$
$\begin{cases}-2x_1 + x_2 + 8x_3 \leq 2 | y_1 \\ x_1 + x_2 + x_3 \leq 4 | y_2\\ x_{1,2,3}\geq0\end{cases}$
Строим двойственную задачу:
$\begin{cases}2y_1 + 4y_2 \to min \\ -2y_1 + y_2 \geq -4 \\ y_1 + y_2 \geq 5 \\ 8y_1 + y_2 \geq 8 \\ y_{1,2}\geq0\end{cases}$
"Можем решить двойственную задачу, и потом перевести решение обратно в исходную"
$g'(y) = (2,4)$
$\begin{cases}-2y_1 + y_2 = -4 \\ y_1 + y_2 = 5\end{cases}$ 
$3y_1 = 9 \rightarrow y_1^*=3, y_2^*=2$ 
$y^* = (3,2)$
$(-2x_1+x_2 + 8x_3-2)y_1=0$
$(x_1+x_2+x_3-4)y_2=0$
$(-2y_1+y_2+4)x_1=0$
$(y_1+y_2-5)x_2=0$
$\underset{\text{не равна нулю}\rightarrow x_3^*=0}{(8y_1+y_2-8)}x_3=0$ 
т.к. $y^*_{1,2}\neq0,$ то $\begin{cases}-2x_1+x_2=2 \\ x_1 + x_2 = 4\end{cases}$ $\rightarrow$ $\begin{cases}3x_1 = 2 \\ x^*_1 = \frac{2}{3} \\ x_2^* = 4 - \frac{2}{3} = \frac{10}{3}\end{cases}$
$x^* = (\frac{2}{3},\frac{10}{3},0)$
$g(y^*) = 14 = f(x^*)$ 


Транспортная задача - ТЗ
m поставщиков - склады
n потребителей - магазины
$a_1,...,a_m$ - запас в пунктах отправления
$b_1,...,b_n$ - потребности
$C_{ij}$ - стоимость перевозки из i в j
$x_{ij}$ - количество перевозимых грузов из i в j
$x = \begin{pmatrix}x_{11} ... x_{1n} \\ ... x_{ij} ... \\ x_{m1} .. x_{mn}\end{pmatrix}$ 
$\overset{m}{\underset{i=1}{\sum}}\overset{n}{\underset{j=1}{\sum}} C_{ij}x_{ij} \to min$
$\begin{cases}\overset{n}{\underset{j=1}{\sum}}x_{ij} = a_i, i = 1,...,m \\ \overset{m}{\underset{i=1}{\sum}}x_{ij} = b_j, j=1,...,n\end{cases}$ $\rightarrow Ax = b$ 
$x_{ij}\geq0, \forall i,j$
$$ A = \begin{pmatrix} x_{11} & x_{12} & \dots & x_{1n} & x_{21} & x_{22} & \dots & x_{2n} & \dots & x_{m1} & x_{m2} & \dots & x_{mn} \\ 1 & 1 & \dots & 1 & 0 & 0 & \dots & 0 & \dots & 0 & 0 & \dots & 0 \\ 0 & 0 & \dots & 0 & 1 & 1 & \dots & 1 & \dots & 0 & 0 & \dots & 0 \\ ... \\ 0 & 0 & \dots & 0 & 0 & 0 & \dots & 0 & \dots & 1 & 1 & \dots & 1 \\ \hline 1 & 0 & \dots & 0 & 1 & 0 & \dots & 0 & \dots & 1 & 0 & \dots & 0 \\ 0 & 1 & \dots & 0 & 0 & 1 & \dots & 0 & \dots & 0 & 1 & \dots & 0 \\ ... \\ 0 & 0 & \dots & 1 & 0 & 0 & \dots & 1 & \dots & 0 & 0 & \dots & 1 \end{pmatrix} $$

$b = \begin{pmatrix}a_1\\ ... \\ a_m \\ b_1 \\ ... \\ b_n\end{pmatrix}$

Теорема (условие разрешения): ТЗ разрешений Т и ГТ, когда $\underset{i=1}{\overset{m}{\sum}}a_i = \underset{j=1}{\overset{n}{\sum}} b_j$ 
Среди m,n условия ограничений линейно независимыми являются m+n-1