[[Базис]][[Базис]][[Базис]]## Симплекс-метод

### Введение

Сегодняшняя лекция посвящена задачам **линейного программирования (ЛП)**. Ранее мы уже ознакомились с графическим методом решения, который показал нам, что оптимальное решение задачи ЛП, если оно существует, всегда находится в одной из угловых точек допустимой области.

### Симплекс-метод

Мы изучим универсальный метод решения задач ЛП, известный как **симплекс-метод**. Этот метод подходит для задач любой размерности, в отличие от графического метода, который применим только для задач с двумя переменными ($n=2$).

**Симплекс** — это обобщение понятия треугольника на n-мерный случай. В контексте ЛП это можно представить как n-мерный многогранник, определяющий допустимую область решений.

Идея симплекс-метода заключается в последовательном переходе от одной угловой точки (вершины) многогранника допустимых решений к другой, смежной, до тех пор, пока не будет найдено оптимальное решение. При каждом переходе значение целевой функции улучшается.

#### Алгоритм симплекс-метода

Алгоритм состоит из двух основных этапов:

1. **Подготовительный этап:**
   - Приведение задачи ЛП к канонической форме.
   - Разделение переменных на базисные и свободные.
   - Нахождение начального опорного плана (базисного решения), что соответствует одной из угловых точек.
   - Заполнение начальной симплекс-таблицы.
		Каноническая форма задачи ЛП, с которой работает симплекс-метод, предполагает, что система ограничений представлена в виде системы линейных уравнений с разрешенными базисными переменными:
		$$
		\begin{cases}
		x_1 + a_{1,m+1}x_{m+1} + \dots + a_{1,n}x_n = b_1 \\
		x_2 + a_{2,m+1}x_{m+1} + \dots + a_{2,n}x_n = b_2 \\
		\dots \\
		x_m + a_{m,m+1}x_{m+1} + \dots + a_{m,n}x_n = b_m
		\end{cases}
		$$
		Здесь:
		-   $x_1, \dots, x_m$ — **базисные переменные (БП)**.
		-   $x_{m+1}, \dots, x_n$ — **свободные (или небазисные) переменные**.
		-   Правые части уравнений должны быть неотрицательными: $b_i \ge 0$.
		
		Приравняв все свободные переменные к нулю, мы получаем первый **опорный план (базисное решение)**:
		$$ X_{\text{баз}} = (b_1, b_2, \dots, b_m, 0, \dots, 0) $$
		Целевая функция также выражается через свободные переменные:
		$$ Z + c_{m+1}x_{m+1} + \dots + c_{n}x_{n} = c_0 $$
		Эти данные заносятся в начальную симплекс-таблицу следующего вида:
		
| БП | СЧ | $x_1$ | $\dots$ | $x_m$ | $x_{m+1}$ | $\dots$ | $x_n$ |
| :--- | :--- | :---: | :---: | :---: | :---: | :---: | :---: |
| $x_1$ | $b_1$ | 1 | $\dots$ | 0 | $a_{1,m+1}$ | $\dots$ | $a_{1,n}$ |
| $\vdots$ | $\vdots$ | $\vdots$ | $\ddots$ | $\vdots$ | $\vdots$ | $\ddots$ | $\vdots$ |
| $x_m$ | $b_m$ | 0 | $\dots$ | 1 | $a_{m,m+1}$ | $\dots$ | $a_{m,n}$ |
| **Z** | $c_0$ | **0** | $\dots$ | **0** | $c_{m+1}$ | $\dots$ | $c_n$ |
Коэффициенты $c_{m+1}, \dots, c_n$ в последней строке называются **оценками**

2. **Основной алгоритм (итерационный процесс):**
   - **Проверка на оптимальность:** Анализируется строка оценок в симплекс-таблице. Если все оценки неотрицательны, текущий план является оптимальным.
   - **Улучшение плана (если он не оптимален):**
     - Если есть отрицательные оценки, но в соответствующих столбцах нет положительных элементов, то целевая функция не ограничена, и задача не имеет решения ($Z \to +\infty$).
     - Если есть отрицательные оценки и в соответствующих столбцах есть положительные элементы, план можно улучшить.
       - Выбирается **разрешающий столбец** (соответствующий переменной, вводимой в базис).
       - Находится **разрешающая строка** (соответствующая переменной, выводимой из базиса) путем нахождения минимального симплексного отношения.
       - Выполняются элементарные преобразования (методом Гаусса) для получения новой симплекс-таблицы.
   - Процесс повторяется до достижения оптимальности.

### Пример решения задачи симплекс-методом

**Условие задачи:**

Максимизировать целевую функцию:
$$ Z = 2x_1 - x_2 + 3x_3 - 2x_4 + x_5 \to \max $$
При ограничениях:
$$
\begin{cases}
-x_1 + x_2 + x_3 = 1 \\
x_1 - x_2 + x_4 = 1 \\
x_1 + x_2 + x_5 = 2 \\
x_j \ge 0, \quad j=1, \dots, 5
\end{cases}
$$

**Решение:**

1.  **Начальный опорный план (базисное решение):**
    - Базисные переменные: $x_3, x_4, x_5$
    - Свободные переменные: $x_1, x_2$ (приравниваются к нулю)
    - Начальный базисный план: $X_{\text{баз}}^1 = (0, 0, 1, 1, 2)$

2.  **Выражение целевой функции через свободные переменные:**
    - Из системы ограничений выражаем базисные переменные:
      $$ x_3 = 1 + x_1 - x_2 $$
      $$ x_4 = 1 - x_1 + x_2 $$
      $$ x_5 = 2 - x_1 - x_2 $$
    - Подставляем их в целевую функцию Z:
      $$ Z = 2x_1 - x_2 + 3(1 + x_1 - x_2) - 2(1 - x_1 + x_2) + (2 - x_1 - x_2) $$
      $$ Z = 3 + 6x_1 - 7x_2 $$
    - Переписываем в виде, удобном для симплекс-таблицы:
      $$ Z - 6x_1 + 7x_2 = 3 $$
    > Смысл этого выражения в том, что при текущем плане, где $x_1=0, x_2=0$, увеличение $x_1$ (с положительным коэффициентом +6) приведет к росту целевой функции $Z$.

3.  **Начальная симплекс-таблица:**

| БП    | СЧ    |  $x_1$ | $x_2$ | $x_3$ | $x_4$ | $x_5$ |
| :---- | :---- | -----: | ----: | ----: | ----: | ----: |
| $x_3$ | 1     |     -1 |     1 |     1 |     0 |     0 |
| $x_4$ | 1     |      1 |    -1 |     0 |     1 |     0 |
| $x_5$ | 2     |      1 |     1 |     0 |     0 |     1 |
| **Z** | **3** | **-6** | **7** | **0** | **0** | **0** |

4.  **Проверка на оптимальность и итерация:**
    - В строке оценок Z есть отрицательный коэффициент (-6), значит, план не оптимален.
    - **Разрешающий столбец:** столбец $x_1$.
    - **Минимальное симплексное отношение:** $\min\{\frac{1}{1}, \frac{2}{1}\} = 1$. Минимум соответствует строке $x_4$.
    - **Разрешающий элемент:** 1 (на пересечении строки $x_4$ и столбца $x_1$).
    - **Пересчет таблицы:**
      - $x_1$ входит в базис, $x_4$ выходит из базиса.
      - Выполняем элементарные преобразования, чтобы в столбце $x_1$ получить единичный вектор с единицей в разрешающей строке.

5.  **Вторая симплекс-таблица:**

| БП      | СЧ | $x_1$ | $x_2$ | $x_3$ | $x_4$ | $x_5$ |
| :------ | :- | ----: | ----: | ----: | ----: | ----: |
| $x_3$   | 2  |     0 |     0 |     1 |     1 |     0 |
| $x_1$   | 1  |     1 |    -1 |     0 |     1 |     0 |
| $x_5$   | 1  |     0 |     2 |     0 |    -1 |     1 |
| **Z**   | **9**  |  **0**|  **1**|  **0**|  **6**|  **0**|

6.  **Итог:**
    - Все оценки в строке Z неотрицательны. Текущий план оптимален.
    - Оптимальный план: $X^* = (1, 0, 2, 0, 1)$
    - Максимальное значение целевой функции: $Z^* = 9$


### Геометрическая интерпретация и логика симплексных отношений

Симплексные отношения, которые мы вычисляем, имеют четкую геометрическую и логическую основу. Когда мы решаем ввести в [[Базис]] новую переменную (например, $x_1$, которая изначально была равна 0), мы по сути двигаемся из одной угловой точки многогранника допустимых решений вдоль одного из его ребер.

Наша цель — двигаться до тех пор, пока значение целевой функции $Z$ максимально возрастает. Переменная $x_1$ увеличивается от 0 до некоторого положительного значения. Однако это увеличение ограничено другими условиями задачи, чтобы мы не вышли за пределы допустимой области.

Поскольку мы решили увеличивать $x_1$, а $x_2$ остается свободной переменной (равной 0 на данном шаге), система ограничений с учетом неотрицательности базисных переменных ($x_3, x_4, x_5 \ge 0$) дает нам следующие условия:
$$
\begin{cases}
x_3 = 1 + x_1 \ge 0 \implies x_1 \ge -1 \\
x_4 = 1 - x_1 \ge 0 \implies x_1 \le 1 \\
x_5 = 2 - x_1 \ge 0 \implies x_1 \le 2
\end{cases}
$$
С учетом того, что $x_1$ сама должна быть $\ge 0$, мы получаем отрезок допустимых значений для $x_1$: 

Целевая функция $Z = 3 + 6x_1$ является **линейной**. [[Необходимые условия максимума|максимум]] линейной функции на отрезке достигается на его правом конце. Следовательно, чтобы максимизировать Z, мы должны выбрать максимально возможное значение, то есть $x_1 = 1$.


**Минимальное симплексное отношение** как раз и находит это предельное значение. Мы рассматриваем только строки с положительными коэффициентами в разрешающем столбце, так как только они накладывают верхнюю границу на увеличение новой базисной переменной. Строки с отрицательными коэффициентами (как в случае с $x_3$) не ограничивают рост $x_1$ сверху, поэтому они не участвуют в поиске разрешающей строки.

### Особые случаи в симплекс-методе

В ходе выполнения алгоритма могут возникнуть особые ситуации:

1.  **Неограниченность целевой функции:** Если на каком-то шаге в строке оценок Z есть отрицательный коэффициент, но в соответствующем ему столбце нет ни одного положительного элемента, это означает, что вводимая в [[Базис]] переменная может неограниченно возрастать, не нарушая допустимости плана. В этом случае целевая функция не ограничена сверху (для задачи максимизации), и оптимального решения не существует ($Z \to +\infty$).

2.  **Альтернативный оптимум (множественность решений):** Если в оптимальной симплекс-таблице (где все оценки $\ge 0$) присутствует нулевая оценка для одной из **свободных (небазисных)** переменных, это указывает на существование бесконечного множества оптимальных решений. Можно ввести эту переменную в [[Базис]], выполнив еще одну итерацию. При этом значение целевой функции не изменится, но будет найден новый оптимальный базисный план. Любая выпуклая линейная комбинация этих двух оптимальных планов также будет являться оптимальным решением.

### Метод искусственного базиса

Для начала работы симплекс-метода требуется исходный допустимый базисный план. В задачах, где ограничения заданы равенствами или неравенствами типа "$\ge$", такой план не всегда очевиден. В таких случаях применяется **метод искусственного базиса**.

Суть метода заключается в решении вспомогательной задачи для нахождения первого опорного плана.

**Алгоритм:**

1.  **Приведение к неотрицательной правой части:** Все уравнения в системе ограничений преобразуются так, чтобы их правые части ($b_i$) были неотрицательными ($b_i \ge 0$). Это делается путем умножения уравнения на -1, если необходимо.

2.  **Введение искусственных переменных:** В каждое уравнение, где нет "готовой" базисной переменной (переменной, входящей только в это уравнение с коэффициентом +1), добавляется новая, **искусственная переменная** $y_i \ge 0$. Эти переменные вместе с уже имеющимися базисными переменными образуют начальный *искусственный [[Базис]]*.

3.  **Формулировка вспомогательной задачи:** Составляется новая целевая функция $F$, которая представляет собой сумму всех искусственных переменных. Эта функция минимизируется:
    $$ F = \sum y_i \to \min $$

4.  **Решение вспомогательной задачи:** Вспомогательная задача решается обычным симплекс-методом. Возможны два исхода:
    -   **$F_{\min} = 0$**: Это означает, что удалось найти такой план, при котором все искусственные переменные равны нулю. Их можно исключить из базиса. Полученный в результате базисный план является допустимым для исходной задачи. Финальная симплекс-таблица этого этапа становится начальной для решения исходной задачи.
    -   **$F_{\min} > 0$**: Это означает, что невозможно избавиться от искусственных переменных. Следовательно, система ограничений исходной задачи несовместна, и допустимых решений не существует.

### Теория двойственности

Для каждой задачи линейного программирования, называемой **прямой (или исходной)**, можно сформулировать соответствующую ей **двойственную** задачу.

#### Построение двойственной задачи

С точки зрения теории оптимизации, двойственность строится с помощью **функции Лагранжа**. Для прямой задачи $f(x) \to \max$ при ограничениях $g_i(x) \le b_i$, функция Лагранжа имеет вид:
$$ L(x, \lambda) = f(x) + \sum \lambda_i (b_i - g_i(x)) $$
Тогда прямая задача эквивалентна $\underset{x \ge 0}{\max} \text{ } \underset{\lambda \ge 0}{\min} L(x, \lambda)$, а двойственная к ней задача определяется как $\underset{\lambda \ge 0}{\min} \text{ } \underset{x \ge 0}{\max} L(x, \lambda)$.

Для стандартной задачи ЛП:
$$L(x, y) = cx + y(b - Ax) = (c - yA)x + yb = (c - A^Ty)x + by$$.
Тогда двойственная задача:
$$ \underset{y \ge 0}{\min} \text{ } \underset{x \ge 0}{\sup}((c - A^Ty)x + by) $$
Внутренняя задача по $x$ будет ограничена (равна $by$) только при условии $c - A^Ty \le 0$, или $A^Ty \ge c$. Это и формирует ограничения двойственной задачи.

Рассмотрим симметричную пару двойственных задач.

**Прямая задача (на [[Необходимые условия максимума|максимум]]):**
$$
\begin{cases}
Z(x) = \sum_{j=1}^{n} c_j x_j \to \max \\
\sum_{j=1}^{n} a_{ij} x_j \le b_i, \quad i=1, \dots, m \\
x_j \ge 0, \quad j=1, \dots, n
\end{cases}
$$

**Двойственная задача (на минимум):**
$$
\begin{cases}
F(y) = \sum_{i=1}^{m} b_i y_i \to \min \\
\sum_{i=1}^{m} a_{ij} y_i \ge c_j, \quad j=1, \dots, n \\
y_i \ge 0, \quad i=1, \dots, m
\end{cases}
$$

**Правила перехода:**

-   Цель максимизации в прямой задаче меняется на минимизацию в двойственной.
-   Коэффициенты целевой функции прямой задачи ($c_j$) становятся свободными членами в ограничениях двойственной.
-   Свободные члены ограничений прямой задачи ($b_i$) становятся коэффициентами целевой функции двойственной.
-   Матрица коэффициентов ограничений транспонируется ($A \to A^T$).
-   Неравенства типа "$\le$" меняются на "$\ge$".
-   Количество переменных в двойственной задаче равно количеству ограничений в прямой, и наоборот.

**Важное замечание:** Если в прямой задаче некоторое ограничение является равенством, то соответствующая ему двойственная переменная будет **свободной от ограничения по знаку**. И наоборот, если в прямой задаче какая-то переменная свободна от ограничения по знаку, то соответствующее ей ограничение в двойственной задаче будет равенством.

#### Теоремы двойственности

1.  **Первая теорема двойственности (слабая):** Для любой пары допустимых решений прямой ($x$) и двойственной ($y$) задач значение целевой функции прямой задачи не превосходит значения целевой функции двойственной: $Z(x) \le F(y)$, или в общем виде:
    $$ c \cdot x \le b \cdot y $$
    **Следствие:** Если для некоторой пары допустимых планов $x^*$ и $y^*$ выполняется равенство $c \cdot x^* = b \cdot y^*$, то $x^*$ и $y^*$ являются оптимальными решениями своих задач.

2.  **Вторая теорема двойственности (сильная):** Если одна из пары двойственных задач имеет оптимальное решение, то и другая имеет оптимальное решение, причем экстремальные значения их целевых функций равны: $Z_{\max} = F_{\min}$. Если целевая функция одной из задач не ограничена, то другая не имеет допустимых решений.

Эти теоремы являются фундаментальными в линейном программировании и позволяют, например, решив одну задачу, сразу получить информацию о решении другой.


### Теория двойственности (продолжение)

#### Теорема о равновесии (Вторая теорема двойственности)
Эта теорема устанавливает условия, при которых допустимые планы прямой и двойственной задач являются оптимальными. Она также известна как **условия дополняющей нежесткости**.

**Теорема:** Если $x^*$ и $y^*$ — оптимальные решения прямой и двойственной задач соответственно, то выполняются следующие условия:
1.  $y_i^* \cdot (b_i - \sum_{j=1}^{n} a_{ij} x_j^*) = 0$ для всех $i = 1, \dots, m$
2.  $x_j^* \cdot (c_j - \sum_{i=1}^{m} a_{ij} y_i^*) = 0$ для всех $j = 1, \dots, n$

**Смысл теоремы:**
1.  Если $i$-е ограничение прямой задачи в оптимальной точке выполняется как **строгое неравенство** (т.е. есть "запас" ресурса), то соответствующая $i$-я двойственная переменная (оценка ресурса) равна **нулю**. Если же двойственная переменная **положительна**, то соответствующее ограничение выполняется как **строгое равенство**.
2.  Аналогично, если $j$-я переменная прямой задачи в оптимальной точке **положительна**, то соответствующее $j$-е ограничение двойственной задачи выполняется как **строгое равенство**. Если же $j$-е ограничение двойственной задачи выполняется как **строгое неравенство**, то соответствующая $j$-я переменная прямой задачи равна **нулю**.

Эти условия позволяют, зная оптимальное решение одной задачи, восстановить решение другой, что является мощным инструментом анализа.

### Применение теории двойственности для решения задачи
Рассмотрим пример, где мы решим двойственную задачу графически, а затем, используя теорему о равновесии, найдём решение исходной (прямой) задачи.

**Прямая задача (ПЗ):**
$$
\begin{cases}
Z = -4x_1 + 5x_2 + 8x_3 \to \max \\
-2x_1 + x_2 + 8x_3 \le 2 \\
x_1 + x_2 + x_3 \le 4 \\
x_{1,2,3} \ge 0
\end{cases}
$$
Здесь 3 переменные, и графически её решить нельзя.

**Двойственная задача (ДЗ):**
$$
\begin{cases}
F = 2y_1 + 4y_2 \to \min \\
-2y_1 + y_2 \ge -4 \\
y_1 + y_2 \ge 5 \\
8y_1 + y_2 \ge 8 \\
y_{1,2} \ge 0
\end{cases}
$$
Здесь 2 переменные, что позволяет использовать графический метод.

**Графическое решение ДЗ:**
1.  Строим область допустимых решений (ОДР) на плоскости $(y_1, y_2)$.
2.  Строим вектор-[[Градиент]] целевой функции $g' = (2, 4)$. Так как задача на минимум, мы ищем точку в ОДР, в которой опорная прямая, перпендикулярная вектору-антиградиенту $(-2, -4)$, коснётся ОДР в первый раз.
3.  Оптимальная точка $y^*$ находится на пересечении прямых (1) и (2):
    $$
    \begin{cases}
    -2y_1 + y_2 = -4 \\
    y_1 + y_2 = 5
    \end{cases}
    $$
    Решая систему, получаем: $3y_1 = 9 \implies y_1^* = 3, y_2^* = 2$.
4.  Оптимальное значение целевой функции: $F_{\min} = 2(3) + 4(2) = 14$. Согласно второй теореме двойственности, $Z_{\max}$ также будет равно 14.

**Нахождение решения ПЗ с помощью условий дополняющей нежесткости:**
1.  Подставим $y^* = (3, 2)$ в ограничения ДЗ:
    -   (1): $-2(3) + 2 = -4 \implies -4 = -4$ (равенство)
    -   (2): $3 + 2 = 5 \implies 5 = 5$ (равенство)
    -   (3): $8(3) + 2 = 26 \implies 26 > 8$ (строгое неравенство)
2.  Применим условия равновесия:
    -   Поскольку третье ограничение ДЗ строгое, соответствующая переменная ПЗ равна нулю: $x_3^* = 0$.
    -   Поскольку двойственные переменные $y_1^* = 3 > 0$ и $y_2^* = 2 > 0$, соответствующие ограничения ПЗ выполняются как равенства. С учетом $x_3^*=0$:
    $$
    \begin{cases}
    -2x_1 + x_2 = 2 \\
    x_1 + x_2 = 4
    \end{cases}
    $$
3.  Решаем эту систему: вычитая первое уравнение из второго, получаем $3x_1 = 2 \implies x_1^* = 2/3$. Тогда $x_2^* = 4 - 2/3 = 10/3$.
4.  Оптимальный план прямой задачи: $X^* = (2/3, 10/3, 0)$.
5.  Проверка: $Z_{\max} = -4(2/3) + 5(10/3) + 8(0) = -8/3 + 50/3 = 42/3 = 14$. Значения совпали, решение верное.
### Транспортная задача (ТЗ)

Транспортная задача — это частный случай задачи линейного программирования, имеющий широкое практическое применение и специальные, более эффективные методы решения.

#### Постановка задачи

-   Имеется **m** пунктов отправления (поставщиков, складов) с запасами продукции $a_1, a_2, \dots, a_m$.
-   Имеется **n** пунктов назначения (потребителей, магазинов) с потребностями $b_1, b_2, \dots, b_n$.
-   Известна стоимость $c_{ij}$ перевозки единицы продукции из $i$-го пункта отправления в $j$-й пункт назначения.

**Цель:** Составить такой план перевозок, чтобы удовлетворить все потребности при минимальных суммарных затратах на транспортировку.

#### Математическая модель

-   **Переменные:** $x_{ij}$ — количество единиц продукции, перевозимой из пункта $i$ в пункт $j$.
-   **Целевая функция (минимизация общих затрат):**
    $$ Z = \sum_{i=1}^{m} \sum_{j=1}^{n} c_{ij} x_{ij} \to \min $$
-   **Ограничения:**
    1.  **По запасам (каждый поставщик вывозит весь свой товар):**
        $$ \sum_{j=1}^{n} x_{ij} = a_i, \quad \text{для каждого } i=1, \dots, m $$
    2.  **По потребностям (каждый потребитель получает весь необходимый товар):**
        $$ \sum_{i=1}^{m} x_{ij} = b_j, \quad \text{для каждого } j=1, \dots, n $$
    3.  **Неотрицательность перевозок:**
        $$ x_{ij} \ge 0, \quad \forall i, j $$
        В матричной форме система ограничений имеет вид $A \cdot x = b$, где матрица $A$ имеет специфическую структуру из нулей и единиц:
$$ A = \begin{pmatrix} 1 & 1 & \dots & 1 & 0 & 0 & \dots & 0 & \dots & 0 & 0 & \dots & 0 \\ 0 & 0 & \dots & 0 & 1 & 1 & \dots & 1 & \dots & 0 & 0 & \dots & 0 \\ \vdots & & & & & & \vdots & & & & & & \vdots \\ 0 & 0 & \dots & 0 & 0 & 0 & \dots & 0 & \dots & 1 & 1 & \dots & 1 \\ \hline 1 & 0 & \dots & 0 & 1 & 0 & \dots & 0 & \dots & 1 & 0 & \dots & 0 \\ 0 & 1 & \dots & 0 & 0 & 1 & \dots & 0 & \dots & 0 & 1 & \dots & 0 \\ \vdots & & & & & & \vdots & & & & & & \vdots \\ 0 & 0 & \dots & 1 & 0 & 0 & \dots & 1 & \dots & 0 & 0 & \dots & 1 \end{pmatrix}, \quad b = \begin{pmatrix}a_1\\ \vdots \\ a_m \\ b_1 \\ \vdots \\ b_n\end{pmatrix} $$


#### Условие разрешимости и типы моделей

**Теорема (условие разрешимости):** Для того чтобы транспортная задача имела решение, необходимо и достаточно, чтобы суммарные запасы были равны суммарным потребностям.
$$ \sum_{i=1}^{m} a_i = \sum_{j=1}^{n} b_j $$
Это условие называется **условием баланса**.

-   **Закрытая модель:** Модель, в которой условие баланса выполняется.
-   **Открытая модель:** Модель, в которой суммарные запасы не равны суммарным потребностям. Такую модель сводят к закрытой путем введения фиктивного поставщика (если спрос превышает предложение) или фиктивного потребителя (если предложение превышает спрос) с нулевыми стоимостями перевозок.

#### Свойства транспортной задачи

-   Среди $m+n$ уравнений ограничений только $m+n-1$ являются линейно независимыми.
-   Следовательно, любой опорный (базисный) план транспортной задачи содержит ровно $m+n-1$ базисных переменных (занятых ячеек в транспортной таблице).
-   План называется **невырожденным**, если он содержит ровно $m+n-1$ положительных компонент.

### Методы нахождения начального опорного плана

Существует несколько методов для построения начального опорного плана (угловой точки).

1.  **Метод северо-западного угла:**
    -   Простой метод, который не учитывает стоимости перевозок.
    -   Заполнение транспортной таблицы начинается с левой верхней (северо-западной) ячейки. В нее записывается максимальное возможное количество груза, ограниченное запасом и потребностью. Затем переходят к соседней ячейке справа или снизу, в зависимости от того, что было исчерпано — потребность или запас.

2.  **Метод минимального элемента (или минимальной стоимости):**
    -   Учитывает стоимости.
    -   На каждом шаге выбирается ячейка с наименьшей стоимостью перевозки $c_{ij}$ во всей таблице. В эту ячейку помещается максимально возможное количество груза. Строка или столбец, где запас или потребность исчерпаны, исключается из рассмотрения.

3.  **Метод Фогеля (аппроксимация Фогеля):**
    -   Более сложный, но обычно дает начальный план, близкий к оптимальному.
    -   Для каждой строки и столбца вычисляются "штрафы" — разности между двумя наименьшими тарифами. Выбирается строка или столбец с наибольшим штрафом, и в ней/нем заполняется ячейка с минимальной стоимостью.

### Метод потенциалов для нахождения оптимального плана

После нахождения начального опорного плана с помощью одного из вышеописанных методов, его оптимальность проверяется и, при необходимости, улучшается с помощью **метода потенциалов**. Этот метод является аналогом симплекс-метода, адаптированным для структуры транспортной задачи.


### Методы нахождения начального опорного плана
Как было сказано ранее, для начала итерационного процесса симплекс-метода необходимо найти начальную угловую точку, или **начальный опорный план**. Для транспортной задачи существуют специальные, более простые методы, которые позволяют это сделать.

#### 1. Метод северо-западного угла

Этот метод является самым простым для построения начального плана, так как он совершенно не учитывает стоимости перевозок $c_{ij}$. Алгоритм заключается в последовательном заполнении ячеек транспортной таблицы, начиная с левой верхней (северо-западной) и двигаясь вправо или вниз.

**Алгоритм:**
1.  Начать с ячейки (1, 1).
2.  В текущую ячейку $(i, j)$ записать максимально возможный объем перевозки: $x_{ij} = \min(a_i, b_j)$, где $a_i$ — текущий запас, а $b_j$ — текущая потребность.
3.  Если была полностью удовлетворена потребность (исчерпан столбец $j$), то следующим шагом переходят к ячейке справа — $(i, j+1)$.
4.  Если был полностью исчерпан запас (исчерпана строка $i$), то переходят к ячейке снизу — $(i+1, j)$.
5.  Если запас и потребность исчерпаны одновременно, происходит **вырождение**, и переход осуществляется по диагонали к ячейке $(i+1, j+1)$.
6.  Процесс повторяется до тех пор, пока все запасы не будут распределены, а потребности — удовлетворены.

**Пример (из видео):**
Рассмотрим заполнение таблицы по этому методу.

1.  **Ячейка (2,2):** Начинаем с северо-западного угла доступной таблицы. Потребность — 7, запас — 3. Перевозим $\min(7,3)=3$. Запас в строке 2 исчерпан (остается 0), потребность в столбце 2 становится $7-3=4$.
2.  **Ячейка (2,3):** Переходим к следующей доступной ячейке в строке. Потребность — 2, запас — 4. Перевозим $\min(2,4)=2$. Запас в строке 2 становится $4-2=2$, потребность в столбце 3 исчерпана (остается 0).
3.  **Ячейка (2,4):** Потребность — 2, запас — 2. Перевозим $\min(2,2)=2$. Запас в строке 2 исчерпан (0), потребность в столбце 4 исчерпана (0).

<br>

**Пример:**
Пусть дана матрица стоимостей $C$, вектор запасов $a$ и вектор потребностей $b$:
$$ C = \begin{pmatrix} 4 & 3 & 2 & 3 & 4 \\ 6 & 5 & 4 & 0 & 2 \\ 1 & 3 & 4 & 5 & 6 \end{pmatrix}, \quad a = (1, 5, 7), \quad b = (3, 3, 3, 2, 2) $$
Проверяем баланс: $\sum a_i = 1+5+7=13$, $\sum b_j = 3+3+3+2+2=13$. Задача закрытая.

Заполним таблицу методом северо-западного угла:

$$
\begin{array}{c|ccccc|c}
  & b_1=3 & b_2=3 & b_3=3 & b_4=2 & b_5=2 & a_i \\
\hline
a_1=1 & \mathbf{1} & & & & & 1 \\
a_2=5 & \mathbf{2} & \mathbf{3} & & & & 5 \\
a_3=7 & & & \mathbf{3} & \mathbf{2} & \mathbf{2} & 7 \\
\hline
b_j & 3 & 3 & 3 & 2 & 2 &
\end{array}
$$

В результате получаем начальный опорный план:
$$
X_{\text{баз}} =
\begin{pmatrix}
1 & 0 & 0 & 0 & 0 \\
2 & 3 & 0 & 0 & 0 \\
0 & 0 & 3 & 2 & 2
\end{pmatrix}
$$

#### Вырожденный опорный план
Количество базисных переменных в невырожденном опорном плане должно быть равно $m+n-1$. В нашем примере $m=3, n=5$, следовательно, должно быть $3+5-1=7$ базисных переменных (занятых ячеек).

В полученном плане у нас только 6 ненулевых перевозок. Это означает, что план является **вырожденным**. Вырождение возникает, когда при заполнении ячейки одновременно исчерпываются и запас, и потребность.

Чтобы продолжить решение методом потенциалов, нам необходимо иметь ровно $m+n-1$ базисных переменных. Для этого одну из пустых ячеек мы должны фиктивно "занять", присвоив ей **нулевую перевозку** и включив её в базис.

**Как выбрать ячейку для базисного нуля?**
-   Чаще всего выбирают пустую ячейку, смежную с той, где произошло вырождение.
-   Предпочтительно выбирать ячейку с наименьшей стоимостью перевозки, чтобы не ухудшать план.

В нашем случае, выбрав ячейку (3,2) в качестве базисной с нулевой перевозкой, мы получаем полный набор из 7 базисных переменных. Такой набор переменных должен быть **линейно независимым**, то есть не образовывать **цикл** в таблице. Цикл — это замкнутый путь, проходящий по базисным ячейкам с поворотами под прямым углом.

#### 2. Метод минимального элемента
Этот метод, в отличие от предыдущего, учитывает стоимости перевозок и, как правило, даёт начальный план, более близкий к оптимальному.

**Алгоритм:**
1.  Во всей матрице стоимостей $C = \{c_{ij}\}$ найти ячейку с минимальным тарифом.
2.  В эту ячейку $(i, j)$ записать максимально возможный объем перевозки: $x_{ij} = \min(a_i, b_j)$.
3.  Исключить из рассмотрения строку $i$ (если исчерпан запас) или столбец $j$ (если удовлетворена потребность). Если исчерпаны оба, исключается только один из них.
4.  Повторять шаги 1-3 для оставшейся части таблицы, пока все грузы не будут распределены.

**Пример:**
Для тех же данных:
1.  **Минимальная стоимость** во всей таблице — 0 в ячейке (2,4). Запас $a_2=5$, потребность $b_4=2$. Перевозим $x_{24} = \min(5,2)=2$. Потребность столбца 4 удовлетворена, остаток запаса $a_2 = 3$.
2.  В оставшейся таблице мин. стоимость — 1 в ячейке (3,1). Запас $a_3=7$, потребность $b_1=3$. Перевозим $x_{31}=\min(7,3)=3$. Потребность столбца 1 удовлетворена, остаток запаса $a_3=4$.
3.  Продолжая аналогично, заполняем ячейки (1,3), (2,5), (3,2) и (3,3).

Итоговый план:
$$
X_{\text{баз}} =
\begin{pmatrix}
0 & 0 & 1 & 0 & 0 \\
0 & 0 & 0 & 2 & 3 \\
3 & 3 & 2 & 0 & 0
\end{pmatrix}
$$

Конечно, вот подробное описание метода Фогеля для вашей лекции.
#### 3. Метод Фогеля (аппроксимация Фогеля)
Этот метод является более сложным в вычислениях, чем предыдущие два, но, как правило, дает начальный опорный план, который либо является оптимальным, либо очень близок к нему. Идея метода заключается в минимизации "штрафов" за неиспользование самых дешевых маршрутов.

**Алгоритм:**

1.  **Вычисление штрафов:** Для каждой строки и каждого столбца, которые еще не исключены из рассмотрения, вычисляется "штраф". Штраф равен абсолютной разности между двумя наименьшими тарифами в этой строке или столбце.
    *   Штрафы показывают, насколько возрастут затраты, если мы не сможем использовать самый дешевый маршрут в данной строке/столбце и будем вынуждены взять второй по дешевизне.

2.  **Выбор строки/столбца:** Находится строка или столбец с **наибольшим** штрафом. Этот выбор указывает на направление, где отказ от самого дешевого маршрута будет наиболее "болезненным".

3.  **Заполнение ячейки:** В выбранной строке или столбце находится ячейка с **минимальной** стоимостью перевозки. В эту ячейку записывается максимально возможный объем перевозки: $x_{ij} = \min(a_i, b_j)$.

4.  **Корректировка:** Уменьшаются соответствующие запас $a_i$ и потребность $b_j$ на величину $x_{ij}$.

5.  **Исключение:** Строка или столбец, запас или потребность которого были полностью исчерпаны, исключается из дальнейшего рассмотрения.

6.  **Повторение:** Шаги 1-5 повторяются до тех пор, пока все запасы не будут распределены, а потребности — удовлетворены.

**Пример:**
Снова используем те же данные:
$$ C = \begin{pmatrix} 4 & 3 & 2 & 3 & 4 \\ 6 & 5 & 4 & 0 & 2 \\ 1 & 3 & 4 & 5 & 6 \end{pmatrix}, \quad a = (1, 5, 7), \quad b = (3, 3, 3, 2, 2) $$

**Итерация 1:**
-   **Штрафы строк:**
    -   Строка 1: $3 - 2 = 1$
    -   Строка 2: $2 - 0 = 2$
    -   Строка 3: $3 - 1 = 2$
-   **Штрафы столбцов:**
    -   Столбец 1: $4 - 1 = 3$
    -   Столбец 2: $3 - 3 = 0$
    -   Столбец 3: $4 - 2 = 2$
    -   Столбец 4: $3 - 0 = 3$
    -   Столбец 5: $4 - 2 = 2$
-   Максимальный штраф равен 3 (в столбцах 1 и 4). Выбираем столбец 1.
-   В столбце 1 минимальная стоимость — $c_{31}=1$.
-   Заполняем ячейку (3,1): $x_{31} = \min(a_3=7, b_1=3) = 3$.
-   Остатки: $a_3 = 4$, $b_1 = 0$. Столбец 1 исключается.

**Итерация 2:**
-   **Штрафы строк:**
    -   Строка 1: $3 - 2 = 1$
    -   Строка 2: $2 - 0 = 2$
    -   Строка 3: $4 - 3 = 1$
-   **Штрафы столбцов (кроме 1-го):**
    -   Столбец 2: $5 - 3 = 2$
    -   Столбец 3: $4 - 2 = 2$
    -   Столбец 4: $3 - 0 = 3$
    -   Столбец 5: $4 - 2 = 2$
-   Максимальный штраф равен 3 (столбец 4).
-   В столбце 4 минимальная стоимость — $c_{24}=0$.
-   Заполняем ячейку (2,4): $x_{24} = \min(a_2=5, b_4=2) = 2$.
-   Остатки: $a_2 = 3$, $b_4 = 0$. Столбец 4 исключается.

Продолжая этот процесс, мы последовательно заполним остальные ячейки. Итоговый опорный план, полученный методом Фогеля, будет выглядеть так:
$$
X_{\text{баз}} =
\begin{pmatrix}
0 & 1 & 0 & 0 & 0 \\
0 & 0 & 1 & 2 & 2 \\
3 & 2 & 2 & 0 & 0
\end{pmatrix}
$$
Этот план содержит $m+n-1 = 3+5-1 = 7$ базисных переменных (занятых ячеек), то есть является невырожденным. Его суммарная стоимость, как правило, значительно ниже, чем у планов, построенных первыми двумя методами.

#### Пример нахождения потенциалов:

Возьмем план, полученный методом северо-западного угла. В нем 6 базисных ячеек, а нужно $m+n-1=7$. План вырожденный. Добавим в базис ячейку (3,2) с нулевой перевозкой.

Базисные ячейки: (1,1), (2,1), (2,2), (3,2), (3,3), (3,4), (3,5).
Система для потенциалов ($u_1=0$):
-   $u_1+v_1 = c_{11} \implies 0+v_1 = 4 \implies v_1=4$
-   $u_2+v_1 = c_{21} \implies u_2+4 = 6 \implies u_2=2$
-   $u_2+v_2 = c_{22} \implies 2+v_2 = 5 \implies v_2=3$
-   $u_3+v_2 = c_{32} \implies u_3+3 = 3 \implies u_3=0$
-   $u_3+v_3 = c_{33} \implies 0+v_3 = 4 \implies v_3=4$
-   $u_3+v_4 = c_{34} \implies 0+v_4 = 5 \implies v_4=5$
-   $u_3+v_5 = c_{35} \implies 0+v_5 = 6 \implies v_5=6$

Потенциалы найдены: $u=(0, 2, 0)$ и $v=(4, 3, 4, 5, 6)$. Теперь для всех свободных ячеек нужно проверить условие $\Delta_{ij} = u_i + v_j - c_{ij} \le 0$. Например, для ячейки (2,4): $\Delta_{24} = u_2+v_4-c_{24} = 2+5-0 = 7 > 0$. План не оптимален.
### Метод потенциалов (проверка на оптимальность)

После нахождения начального опорного плана (например, методом северо-западного угла) необходимо проверить его на оптимальность. Для этого используется **метод потенциалов**, который основан на теоремах двойственности для транспортной задачи.

**Идея метода:**
1.  Каждой строке $i$ транспортной таблицы сопоставляется **потенциал поставщика** $u_i$.
2.  Каждому столбцу $j$ сопоставляется **потенциал потребителя** $v_j$.

Эти потенциалы являются переменными двойственной задачи.

**Условия оптимальности:**
План перевозок является оптимальным, если для него можно найти такую систему потенциалов $u_i$ и $v_j$, что:
-   Для всех **базисных (занятых)** ячеек выполняется равенство: $u_i + v_j = c_{ij}$.
-   Для всех **свободных (пустых)** ячеек выполняется неравенство: $u_i + v_j \le c_{ij}$.

**Алгоритм нахождения потенциалов и проверки оптимальности:**
1.  Для найденного опорного плана (с $m+n-1$ базисными ячейками) составляется система уравнений вида $u_i + v_j = c_{ij}$ для всех базисных ячеек.
2.  Эта система будет содержать $m+n-1$ уравнений и $m+n$ неизвестных. Чтобы система имела единственное решение, один из потенциалов (любой, например, $u_1$) принимается равным нулю: $u_1 = 0$.
3.  Остальные $m+n-1$ потенциалов однозначно определяются из системы.
4.  После нахождения всех потенциалов для каждой **свободной** ячейки вычисляется разность $\Delta_{ij} = u_i + v_j - c_{ij}$.
5.  Если все $\Delta_{ij} \le 0$, то текущий план является **оптимальным**.
6.  Если существует хотя бы одна ячейка, для которой $\Delta_{ij} > 0$, план не оптимален и его можно улучшить.

Если план не оптимален, выбирается ячейка с **наибольшей положительной оценкой** $\Delta_{ij}$. Эта ячейка вводится в базис, после чего строится цикл пересчета для улучшения плана, и процесс повторяется.