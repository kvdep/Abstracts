[[Метод Ньютона]]
$f(x) \to max, x \in X$
$f(x) - f(x^{(k)}) = <f'(x(^{(k)})), x-x^{(k)}> + \frac{1}{2} <f''(x^{(k)})(x-x^{(k)}),(x-x^{(k)})> + O(|x-x^{(k)}|^2)$  
(Разложение $f$ в ряд Тейлора)
Решаем вспомогательную задачу:
$y_k(x) = <f'(x^{(k)}),x-x^{(k)}> + \frac{1}{2}<f''(x^{(k)}(x-x^{(k)})),(x-x^{(k)})> \to max_{x \in X}$ 
Пусть $\tilde{x}^{(k)}$ - решение вспомогательной задачи
$x^{(k+1)} = x^{(k)} + \alpha^{(k)}(\tilde{x}^{(k)} - x^{(k)}), 0 \leq \alpha^{(k)} \leq 1$ 
$x^{(k+1)} = \alpha^{(k)} \tilde{x}^{(k)} + (1 - \alpha^{(k)}) x^{(k)}$ 
Обычный [[Метод Ньютона]]: $\alpha=1 \Rightarrow x^{(k+1)} = \tilde{x}^{(k)} | X = R^n$ 
Необходимые условия экстремума: $(X = R^n): y'_k(x) = f'(x^{(k)}) + f''(x^{(k)})(x-x^{(k)}) = 0 \Rightarrow \tilde{x}^{(k)} = x^{(k+1)} = x^{(k)} - (f''(x^{(k)}))^{-1} f'(x^{(k)})$

В отличие от [[Градиент|градиента]], м. Ньютона не имеет проблем с овражными изолиниями, но может расходиться
Дает решение только если вторая производная отрицательная (только при отрицательном будет max)

$f(x) = -x^2_1 - x^2_2 + x_1 + x_2 \to max$
Начальная точка: $(0,0)$
$f'(x) = (-2x_1+1,-2x_2+1), f'(0,0) = (1,1)$
$f''(x) = \begin{pmatrix} -2 & 0 \\ 0 & -2 \end{pmatrix}; |f''(x)| = 4 \Rightarrow (f'')^{-1}=\frac{1}{4} \begin{pmatrix} -2 & 0 \\ 0 & -2 \end{pmatrix}$ 
$x^{(1)} = \begin{pmatrix} 0 \\ 0 \end{pmatrix} - \begin{pmatrix} -2 & 0 \\ 0 & -2 \end{pmatrix} \begin{pmatrix} 1 \\ 1 \end{pmatrix} = -\frac{1}{4} \begin{pmatrix} -2 \\ -2 \end{pmatrix} = \begin{pmatrix} \frac{1}{2} \\ \frac{1}{2} \end{pmatrix} = x^*$ 
$f(x) \to max, x \in X = \{x|x\in R^n, g_i(x) = 0, i =1, ..., m\}$
$L(x,\lambda) = f(x) + \sum^m_{i=1}\lambda_i g_i (x) = f(x) + <\lambda,g(x)> \to max_{x\in R^n}$

Теорема (принцип Лагранжа):
$f(x), g_i(x), i=1,...,m$ - непрерывно дифференцируемы в некоторой точке $x^*$ и $g'_i(x^*)$ - линейно независимы $\Rightarrow$  $\exists \lambda^*$  $\frac{\partial L(x^*,\lambda^*)}{\partial x_j} = 0$ 

Достаточное условие: 
$1) f \text{ и } g_i$ - непрерывны, дифференцируемы в окрестности $x^*$
$2) g'_i(x^*)$ - линейно независимы
$3) L(x^*,\lambda^*)=0$
$4)<L''_{xx}h,h> <0, \forall h <g_x',h> = 0$
(Объяснение:
 1.можем строить ряд Тейлора вблизи $x^{*}$
 2.условие регулярности, обеспечивает единственность $\lambda$
 3.это стационарная точка
 4.$L''_{xx}h$ - Гессиан (матрица вторых производных по x), h - вектор из пространства касательных; если [[Матрица Гессе|гессиан]] <0 то это т. минимума, если >0 то максимума.
 )


$\tilde{G} = \begin{pmatrix} 0_{m x m} & g_x' \\ (g_x')^T & L''_{xx} \end{pmatrix}$ - [[Расширенная матрица Гессе]]
$(-1)^m\Delta_k > 0, k = m+n,...,2m+1$, то имеем min
$(-1)^{m+k}\Delta_k > 0, k = m+n,...,2m+1$, то имеем max

Пример:
$4x_1 + x_1^2 + x_2^2 \to extr, x\in X = \{x|x_1 + x_2 = 200\}$
$L(x,\lambda) = 4x_1 + x_1^2 + x_2^2 + \lambda(x_1 + x_2 - 200) \to max_{x\in R^2}$
$\begin{cases} L'_{x1} = 4 + 2x_1 + \lambda = 0 \\ L'_{x_2} = 2x_2 + \lambda = 0 \\ L'_{lambda} = x_1 + x_2 - 200 = 0 \end{cases}$ 
$g(x) = x_1+x_2 - 200 = 0$
$g'_x=(1,1) \neq 0 \Rightarrow_{\text{Условия линейной независимости выполняются}}$
$\alpha_1 g'_1+\alpha_2 g'_2 + ... + \alpha_m g'_m = 0$, если $\alpha_i = 0$ 
$\alpha g' = 0$
[[Линейная независимость]] когда сам [[Градиент]] ненулевой
$\begin{cases} L'_{x1} = 4 + 2x_1 + \lambda = 0 \\ L'_{x_2} = 2x_2 + \lambda = 0 \\ L'_{lambda} = x_1 + x_2 - 200 = 0 \end{cases} \Rightarrow 4+2 x_1 = 2x_2,\text{ } \begin{cases} 2x_1 - 2x_2 = -4 \\ x_1 + x_2 = 200 \end{cases}$ $\Rightarrow \begin{cases} x1 = 99 \\ x2 = 101 \\ \lambda^* = -202 \end{cases}$    

$\begin{cases} L'_{x1} = 4 + 2x_1 + \lambda = 0 \\ L'_{x_2} = 2x_2 + \lambda = 0 \\ L'_{lambda} = x_1 + x_2 - 200 = 0 \end{cases}$ $\Rightarrow \tilde{G} = \begin{pmatrix}0 & 1 & 1 \\ 1 & 2 & 0 \\ 1 & 0 & 2\end{pmatrix}$
(Подробнее как получилась [[Матрица Гессе]]:
 Смотрим в определение и сравниваем
 Сверху слева матрица нулей mxm, m = 1 потому что ограничений (g) одно
 сверху справа и снизу слева $g'_x$. Это будут коэффициенты при $x_{1},x_{2}$ в уравнении $L'_{\lambda}$  
 Снизу справа [[Матрица Гессе]] вторых производных. Эти коэффициенты получаются из $L''_{x_1,x_1},L''_{x_1,x_2},L''_{x_2,x_1},L''_{x_2,x_2}$ соответственно.
 )
$n = 2, m=1; \begin{cases} n+m = 3 \\ 2m + 1 = 3 \end{cases}; (-1)^1 \Delta_3 = - \begin{vmatrix}0 &1&1\\1&2&0\\1&0&2\end{vmatrix} = -(0+0+0-2-0-2) = 4>0 \Rightarrow$ т. локального минимума
n - количество переменных
m - количество условий
$x_{1,2} \to \pm \infty \in X, f(x) \to +\infty$ $\Rightarrow x^*$ - глобальный минимум


[[Задача Математического Программирования]] <=> ЗМП
Определение ЗМП: $f(x) \to max$ (Важно конкретизировать экстремум) $, x \in X = \{x|x \in P,g_i(x)\geq 0, i = 1,...,m\}$  
(Отличие от просто нахождения максимума f при g: g=0 в обычной задаче, $g\geq0$ в ЗМП)
$P$ - множество простого типа: $\boxed{R^n, x \geq 0}, a \leq x \leq b$ и т.д.
$L(x,\lambda) = f(x)+<\lambda,g(x)> \to max_{x\in P}$
$\boxed{R^n, x \geq 0} (\text{ограничимся ими})$
[[Активное ограничение]]: $g_i(x^*)=0$ (в точке оптимального решения превращается в равенство); [[Градиент|grad]]: $g_i'(x^*)$ 
[[Простые ограничения]]: $x_j^*=0$; [[Градиент|grad]]: $e_j = (0,0,...,1_{\text{в точке j}},0)$, всего чисел n


<<<<<<< HEAD
Необходимые условия максимума (условия Куна-Таккера):
 Если в т. $x^*$ (т.max) выполняется условие регулярности: градиенты активных и простых активных ограничений линейно независимы $\Rightarrow$ 
  $\exists\lambda^*\geq0:$
  $L'_{x_j}(x^*,\lambda^*) \leq 0, j=1,...,n$ , 
=======

[[Необходимые условия максимума]] ([[Необходимые условия максимума|условия Куна-Таккера]]):

 Если в т. $x^*$ (т.max) выполняется условие регулярности: [[Градиент|градиенты]] активных и простых [[Активное ограничение|активных ограничений]] [[Линейная независимость|линейно независимы]] $\Rightarrow$  $\exists\lambda^*\geq0:L'_{x_j}(x^*,\lambda^*) \leq 0, j=1,...,n$ , 

>>>>>>> a7d29506b43ab1ccea4e7c25a44e63b5c29e3b36
 $L'_{x_j}(x^*,\lambda^*) \cdot x^*_j = 0, j=1,...,n$ , 
 $L'_{\lambda_i}(x^*,\lambda^*) = g_i(x^*) \geq 0$ ,
 $g_i(x^*) \cdot \lambda_i^* = 0$, $i = 1,...,m$ - условие дополнительной нежесткости
 $x_j^* \geq 0, j = 1,...,n$ 



[[Ортант]] <=> это обобщение понятий квадранта и [[Ортант|октанта]] на любое n-мерное пространство

$P = R^2$
$L(x,\lambda) = f(x) + <\lambda,g(x)> \to max_{x\in R^n}$ 
Если ограничений нет, то как меняются условия?
Условие [[Необходимые условия максимума|К-Т]]: 
$L'_{x_j}(x^8,\lambda^*) = 0, j = 1,...,n$
$g_i(x^*) \geq 0$, $g_i(x^*)\lambda^*_i=0, i=1,...,m$

Пример:
$f(x)=x_1^2 + (x_2-2)^2 \to max$, 
$\begin{cases} 3x_1 = x_2 \leq 6 \\ -x_1+x_2 \leq 2 \\ x_{1,2} \geq 0 \end{cases}$ $\Rightarrow
В каких точках выполняется условие Куна-Таккера?
Найти глобальный max
$\begin{cases} 3x_1 = x_2 \leq 6 \\ -x_1+x_2 \leq 2 \\ x_{1,2} \geq 0 \end{cases}$ $\Rightarrow$ $\begin{cases}g_1 = 6-3x_1-x_2 \\ g_2 = 2  - x_2 + x_1 \\ g_3 = x1, g_4 =x_2\end{cases}$ 
![[[[Pasted image 20250905115932.png]]]]
Условия регулярности выполняются потому что они не коллинеарны


$\begin{cases} L = x_1^2 + (x_2-2)^2 + \lambda_1(6-3x_1-x_2) + \lambda_2(2+x_1-x_2) \to \max_{x_{1,2} \geq 0} \\  L'_{x_1} = 2x_1 - 3\lambda_1 + \lambda_2 \leq 0, \quad (2x_1 - 3\lambda_1 + \lambda_2)x_1 = 0 \\ L'_{x_2} = 2(x_2-2) - \lambda_1 - \lambda_2 \leq 0, \quad (2(x_2-2) - \lambda_1 - \lambda_2)x_2 = 0 \\ 6-3x_1-x_2\geq 0, (6-3x_1-x_2)\lambda_1 = 0, \lambda_{1,2}\geq0 \\ 2+x_1-x_2 \geq 0, (2+x_1 - x_2)\lambda_2 = 0, \lambda_{1,2} \geq 0 \end{cases}$

$1) A(0,2), x_1= 0,x_2=2\neq 0$ 
 $L'_{x_2} = 2(x_2-2)-\lambda_1 - \lambda_2 = 0$ 
 $g_2(0,2) = 0, g_1(0,2) > 0 = \lambda_1=0 \Rightarrow \lambda_2=0, L'_{x_1}=0$ 
 Условия [[Необходимые условия максимума|К-Т]] выполнены, точка подозрительна на [[Необходимые условия максимума|максимум]]

$2) O(0,0), x_1=x_2=0$ 
 $g_1>0,g_2>0 \Rightarrow \lambda_1 = \lambda_2 = 0$
 $L'_{x_1}=0, L'_{x_2}<0$
 Подозрительна на максимум

$3)C(2,0), x1=2 \neq 0, x_2 = 0$
 $L'_{x_1} = 2x_1 - 3\lambda_1 + \lambda_2 = 0$
 $g_1 = 0, g_2>0 \Rightarrow \lambda_2=0$
 $x_1 = \frac{4}{3} > 0, L'_{x_2} < 0$
 Подозрительна на максимум

$4)B(1,3), x_1=1, x_2 = 3 \Rightarrow$
 $\begin{cases}2x_1-3\lambda_1+\lambda_2=0 \\ 2(x_2-2)-\lambda_1 - \lambda_2 = 0\end{cases} \Rightarrow \begin{cases}-3\lambda_1 + \lambda_2 = -2 \\ -\lambda_1 - \lambda_2 = -2\end{cases} \Rightarrow -4\lambda_1 = -4; \lambda_1=1=\lambda_2$ 
 Подозрительна на максимум

$5) OC: 0 < x_1 < 2, x_2 = 0$
 $L'_{x_1} = 2x_1 - 3\lambda_1 + \lambda_2 = 0$ 
 $g_1 > 0, g_2 > 0 \Rightarrow \lambda_1 = \lambda_2 = 0$
 $2x_1 \leq 0 \Rightarrow x_1 \leq 0$ 
 Условие [[Необходимые условия максимума|К-Т]] не выполняются, нет подозрительных точек на границе

$6)OA: x_1 = 0, 0<x_2<2$
 $L'_{x_2} = 2(x_2 - 2)-\lambda_1-\lambda_2=0$
 $g_1>0,g_2>0 \Rightarrow \lambda_1=\lambda_2=0$
 Условия не выполняются, нет подозрительных точек

$7) AB: g_2=0, 0<x_1<1, 2<x_2<3$
 $g_1>0 \Rightarrow \lambda_1 = 0$
 $\begin{cases}2x_1 + \lambda_2 = 0 \\ 2(x_2-2)-\lambda_2=0 \\ -x_1 + x_2=2\end{cases}$ $\Rightarrow \begin{cases}-2x_1 = 2(x_1-2) \\ -x_1 - x_2 = -2 \\ -x_1 + x_2 = 2\end{cases}$ $\Rightarrow \begin{cases}x_1 = 0 \\ x_2 = 2\end{cases}$ 
 Условие не выполняется, нет точек подозрительных на максимум

$8)BC: g_1 = 0, 1<x_1<2, 0<x_2<3$
 $g_2>0 \Rightarrow \lambda_2 = 0$
 $\begin{cases}2x_1-3\lambda_1 = 0 \\ 2(x_2-2)- \lambda_1 = 0 \\ 3x_1 + x_2 = 6 \end{cases}$ $\Rightarrow \begin{cases}\frac{2}{3}x_1=2(x_2-2) \\ x_1-3x_2 = -6 \\ 3x_1 + x_2 = 6\end{cases}$ $\Rightarrow \begin{cases}x_1 = \frac{6}{5} = 1.2 \\ x_2=2.4\end{cases}$
 $\lambda_1 = \frac{4}{5}$
 Подозрительная

$9) x_1>0, x_2>0 , g_1 > 0, g_2 > 0 \Rightarrow \lambda_1 = \lambda_2 = 0 \Rightarrow L'_{x_1} = 0, L'_{x_2}=0 \Rightarrow x_1=0, x_2 = 2$
Условие не выполнено

$x_1^2 + (x_2-2)^2 = C$, рисуем окружности (f это функция задающая окружности где f=const)
$A(0,2)$ - глобальный минимум
$O$ не является локальным максимумом 
$C(2,0)$ - точка локального максимума
$B(1,3)$ - точка локального максимума
Точка на BC не является локальными максимумом

по [[Теорема Вейерштрассе|теореме Вейерштрассе]]: глобальный [[Необходимые условия максимума|максимум]] в точке C(2,0)


[[Седловые точки]]
 Определение: $(x^*, y^*)$ - [[Седловые точки|седловая точка]] функции $\mathscr{F}(x,y)$, заданной на таком $X * Y$, если $F(x,y^*) \leq F(x^*,y^*) \leq F(x^*,y) \forall x\in X, \forall y \in Y$ <=> $max(F(x,y^*)) = F(x^*,y^*) = min_{y\in Y}F(x^*,y)$ 

Нахождение седловой точки:
 $\phi(x) = min_{y\in Y}\mathscr{F}(x,y), v_1 = max_{x\in X}\phi(x)=max_{x\in X}min_{y\in Y}\mathscr{F}(x,y)$ - [[Максимин]]
 $\psi(y)=max_{x\in X}\mathscr{F}(x,y),v_2=min_{y\in Y}\psi(y)=min_{y\in Y}max_{x\in X}\mathscr{F}(x,y)$ - [[Минимакс]]

Лемма: $v_1 \leq v_2$
 Когда равны - это седловая точка
Доказательство:
 $min_{y\in Y}F(x,y) \leq F(x,y'), \forall y'\in Y; max_{x\in X}min_{y\in Y}F(x,y) \leq max_{x\in X}F(x,y'),\forall y'\in Y$
 $v_1=max_{x\in X}min_{y\in Y}F(x,y) \leq min_{y\in Y}max_{x\in X}F(x,y) = v_2$, что и требовалось доказать

Теорема: Необходимые и достаточные условия существования седловой точки
 $F(x,y)$ имеет седловую точку $(x^*,y^*)$ на $X * Y$ <=> $max_{x\in X} inf_{y\in Y}F(x,y) = min_{y\in Y}sup_{x\in X} F(x,y)$  
 т.е. внутренние экстремумы не должны достигаться

Пример 1:
 $F(x,y) = x-y, x\in [0,1],y\in [0,1]$
 $v_1 = max_{x\in[0,1]}min_{y\in[0,1]}(x-y) = max_{x\in[0,1]}(x-1)=0, x^*=1$ 
 $v_2 = min_{y\in[0,1]}max_{x\in[0,1]}(x-y) = min_{y\in[0,1]}(1-y)=0,y^*=1$
 $v_1=v_2=0$
 $(x^*,y^*)=(1,1)$

Пример 2:
 Условие: найти cед. т. $F(x,y) = (x-y)^2$
 $v_1=max_{x\in[0,1]}min_{y\in [0,1]}(x-y)^2=max_{x\in [0,1]}0 = 0$ 
 $v_2 = min_{y\in Y}max_{x\in X}(x-y)^2 = min\begin{cases}min \{ (1-y)^2 \\ y\in[0,\frac{1}{2}]\end{cases}, \begin{cases} min(0-y)^2 \\ y\in[\frac{1}{2},1]\end{cases} \}$  