[[Константа Липшица|условие Липшица]] для [[Градиент|градиента]]

Пусть $f(x)$ — дважды непрерывно дифференцируемая функция, [[Градиент]] которой удовлетворяет **условию Липшица**: $||f'(u) - f'(v)|| \leq L ||u - v||$. Здесь $L$ — [[Константа Липшица]]. Для того чтобы функция $f(x)$ могла убывать (или возрастать, в зависимости от контекста оптимизации), необходимо выбрать параметр $\alpha$ из интервала $0 < \alpha^{(k)} \leq \frac{2}{L}$.

Пример 1: Нахождение константы Липшица для $f(x) = -x_1^2 - x_2^2 + x_1 + x_2 \to \max$}

• Вектор $u = (u_1, u_2)$, $v = (v_1, v_2)$.

• Градиент функции $f(x)$ равен: $f'(x) = (-2x_1 + 1, -2x_2 + 1)$.

• Вычислим норму разности градиентов: $||f'(u) - f'(v)|| = ||(-2u_1 + 1, -2u_2 + 1) - (-2v_1 + 1, -2v_2 + 1)||$. $= ||(-2u_1 + 2v_1, -2u_2 + 2v_2)||$ $= ||(-2(u_1 - v_1), -2(u_2 - v_2))||$ $= |2| \cdot ||(u_1 - v_1, u_2 - v_2)||$ $= 2 ||u - v||$.

• Из этого следует, что **константа Липшица $L = 2$**.

• Тогда для сходимости $\alpha$ должно быть в диапазоне: $0 < \alpha^{(k)} \leq \frac{2}{2} \Rightarrow$  $0 < \alpha^{(k)} \leq 1$.

\subsubsection*{Пример 2: Нахождение константы Липшица для $f(x) = 10x_1 + 10x_2 - x_1^2 - 5x_2^2 \to \max$}

• Вектор $u = (u_1, u_2)$, $v = (v_1, v_2)$.

• Градиент функции $f(x)$ равен: $f'(x) = (10 - 2x_1, 10 - 10x_2)$.

• Вычислим норму разности градиентов: $||f'(u) - f'(v)|| = ||(10 - 2u_1, 10 - 10u_2) - (10 - 2v_1, 10 - 10v_2)||$ $= ||(-2u_1 + 2v_1, -10u_2 + 10v_2)||$ $= ||(-2(u_1 - v_1), -10(u_2 - v_2))||$ $\leq \textbf{10}||(u_1 - v_1, u_2 - v_2)||$.

• Здесь $\textbf{константа Липшица $L = 10$}$. (Чем больше $L$, тем меньше интервал для $\alpha$).

• Тогда для сходимости $\alpha$ должно быть в диапазоне: $0 < \alpha^{(k)} \leq \frac{2}{10} \Rightarrow 0 < \alpha^{(k)} < \frac{1}{5}$.

Метод Ньютона

Рассмотрим применение **метода Ньютона** для задачи максимизации. Формула итерации метода Ньютона: $x^{(k+1)} = x^{(k)} - (f''(x^{(k)}))^{-1} \cdot f'(x^{(k)})$.

Пример: $f(x) = 10x_1 + 10x_2 - x_1^2 - 5x_2^2 \to \max$ с начальной точкой $x^{(0)} = (0,0)$

1. **Вычисляем градиент $f'(x)$:** $f'(x) = (10 - 2x_1, 10 - 10x_2)$.

2. **Градиент в начальной точке $x^{(0)}=(0,0)$:** $f'(0,0) = (10, 10)$.

3. **Вычисляем матрицу Гессе $f''(x)$ (матрица вторых производных):** $f''(x) = \begin{pmatrix} -2 & 0 \ 0 & -10 \end{pmatrix}$.

4. **Находим определитель матрицы Гессе и обратную матрицу:** $\det(f''(x)) = (-2) \cdot (-10) - 0 \cdot 0 = 20$. $(f''(x))^{-1} = \frac{1}{20} \begin{pmatrix} -10 & 0 \ 0 & -2 \end{pmatrix}$.

5. **Выполняем первую итерацию $x^{(1)}$:** $x^{(1)} = \begin{pmatrix} 0 \ 0 \end{pmatrix} - \frac{1}{20} \begin{pmatrix} -10 & 0 \ 0 & -2 \end{pmatrix} \cdot \begin{pmatrix} 10 \ 10 \end{pmatrix}$. $x^{(1)} = \begin{pmatrix} 0 \ 0 \end{pmatrix} - \frac{1}{20} \begin{pmatrix} -10 \cdot 10 + 0 \cdot 10 \ 0 \cdot 10 + (-2) \cdot 10 \end{pmatrix}$ $x^{(1)} = \begin{pmatrix} 0 \ 0 \end{pmatrix} - \frac{1}{20} \begin{pmatrix} -100 \ -20 \end{pmatrix}$ $x^{(1)} = \begin{pmatrix} 0 \ 0 \end{pmatrix} - \begin{pmatrix} -5 \ -1 \end{pmatrix} = \begin{pmatrix} 5 \ 1 \end{pmatrix}$. Таким образом, $x^{(1)} = (5,1)$.

6. **Проверяем градиент в $x^{(1)}$:** $f'(5,1) = (10 - 2 \cdot 5, 10 - 10 \cdot 1) = (0,0)$. Поскольку градиент равен нулю, точка $(5,1)$ является стационарной, и метод сошелся за одну итерацию, что характерно для квадратичных функций при методе Ньютона.

Задача Математического Программирования (ЗМП) и Условия Куна-Таккера

Рассмотрим ЗМП: $f(x) \to \max$, $x \in X = {x | x \in P, g_i(x) \geq 0, i = 1, ..., m}$. В данном случае, мы ищем максимум функции $f(x)$ при заданных ограничениях-неравенствах.

Пример: Найти точки, где выполняются условия Куна-Таккера, и глобальный максимум

Задача: $f(x) = x_1^2 + x_2^2 - 6x_1 - 4x_2 \to \max$ Ограничения: $\begin{cases} x_1 + x_2 \leq 5 \ x_1 \geq 0 \ x_2 \geq 0 \end{cases}$.

1. **Преобразуем ограничения к виду $g_i(x) \geq 0$:** $g_1(x) = 5 - x_1 - x_2 \geq 0$. $g_2(x) = x_1 \geq 0$ (это простое ограничение, которое можно записать как $x_1 \geq 0$) $g_3(x) = x_2 \geq 0$ (это простое ограничение, которое можно записать как $x_2 \geq 0$) Простые ограничения $x_{1,2} \geq 0$ учитываются в условиях Куна-Таккера.

2. **Составим функцию Лагранжа:** $L(x, \lambda) = x_1^2 + x_2^2 - 6x_1 - 4x_2 + \lambda(5 - x_1 - x_2)$. Здесь $\lambda$ - множитель Лагранжа для ограничения $g_1$.

3. **Запишем условия Куна-Таккера:** 
$$
\begin{align}
L'_{x_1} = 2x_1 - 6 - \lambda &\leq 0 \\
(2x_1 - 6 - \lambda)x_1 &= 0 \\
L'_{x_2} = 2x_2 - 4 - \lambda &\leq 0 \\
(2x_2 - 4 - \lambda)x_2 &= 0 \\
5 - x_1 - x_2 &\geq 0 \\
(5 - x_1 - x_2)\lambda &= 0 \\
\lambda &\geq 0 \\
x_1 &\geq 0 \\
x_2 &\geq 0 
\end{align}
$$
. Условия регулярности (линейная независимость градиентов активных ограничений) здесь выполняются, так как градиенты ограничений не коллинеарны.

4. **Анализируем подозрительные точки (кандидаты на максимум) и области на границе допустимой области:** Допустимая область - это треугольник с вершинами (0,0), (5,0), (0,5).

    ◦ 1. Точка O(0,0): $x_1=0, x_2=0$. $g_1(0,0) = 5 > 0 \Rightarrow \lambda = 0$. Проверяем $L'_{x_1}$ и $L'_{x_2}$: $L'_{x_1} = 2(0) - 6 - 0 = -6 \leq 0$.__$L'_{x_2} = 2(0) - 4 - 0 = -4 \leq 0$. Условия К-Т выполнены. Точка **O(0,0) подозрительна на максимум**.

    ◦ 2. Точка B(5,0): $x_1=5, x_2=0$. $x_1 \neq 0 \Rightarrow L'_{x_1} = 2x_1 - 6 - \lambda = 0 \Rightarrow 2(5) - 6 - \lambda = 0 \Rightarrow 4 - \lambda = 0 \Rightarrow \lambda = 4$.__$x_2 = 0$.__$g_1(5,0) = 5 - 5 - 0 = 0$. Условие $(5 - x_1 - x_2)\lambda = 0$ выполнено. $\lambda = 4 \geq 0$.__Проверяем $L'_{x_2}$: $L'_{x_2} = 2(0) - 4 - \lambda = -4 - 4 = -8 \leq 0$. Условия К-Т выполнены. Точка **B(5,0) подозрительна на максимум**.

    ◦ 3. Точка A(0,5): $x_1=0, x_2=5$. $x_2 \neq 0 \Rightarrow L'_{x_2} = 2x_2 - 4 - \lambda = 0 \Rightarrow 2(5) - 4 - \lambda = 0 \Rightarrow 6 - \lambda = 0 \Rightarrow \lambda = 6$.__$x_1 = 0$.__$g_1(0,5) = 5 - 0 - 5 = 0$. Условие $(5 - x_1 - x_2)\lambda = 0$ выполнено. $\lambda = 6 \geq 0$. __Проверяем $L'_{x_1}$: $L'_{x_1} = 2(0) - 6 - \lambda = -6 - 6 = -12 \leq 0$. Условия К-Т выполнены. Точка **A(0,5) подозрительна на максимум**.

    ◦ \textbf{4. Отрезок OA ($x_1=0, 0 < x_2 < 5$):} $x_1 = 0$. $g_1 > 0 \Rightarrow \lambda = 0$. $L'_{x_1} = 2(0) - 6 - 0 = -6 \leq 0$. Условие $(2x_1 - 6 - \lambda)x_1 = 0$ выполнено.__$L'_{x_2} = 2x_2 - 4 - 0 = 2x_2 - 4$. Для $0 < x_2 < 2$, $L'_{x_2} < 0$. Для $x_2=2$, $L'_{x_2} = 0$. Для $2 < x_2 < 5$, $L'_{x_2} > 0$.__Следовательно, на этом отрезке только точка $(0,2)$ удовлетворяет условиям К-Т, так как $L'_{x_2}$ должен быть $\leq 0$ и $(L'_{x_2})x_2=0$ (что верно для $x_2 \neq 0$ только при $L'_{x_2}=0$). Точка $(0,2)$ подозрительна на максимум.

    ◦ 5. Отрезок OB ($x_2=0, 0 < x_1 < 5$): $x_2 = 0$. $g_1 > 0 \Rightarrow \lambda = 0$. $L'_{x_2} = 2(0) - 4 - 0 = -4 \leq 0$. Условие $(2x_2 - 4 - \lambda)x_2 = 0$ выполнено.__$L'_{x_1} = 2x_1 - 6 - 0 = 2x_1 - 6$. Для $0 < x_1 < 3$, $L'_{x_1} < 0$. Для $x_1=3$, $L'_{x_1} = 0$. Для $3 < x_1 < 5$, $L'_{x_1} > 0$. Аналогично, только точка $(3,0)$ удовлетворяет условиям К-Т. Точка $(3,0)$ подозрительна на максимум.

    ◦ 6. Отрезок AB ($g_1=0, 0 < x_1 < 5, 0 < x_2 < 5$): На этом отрезке $5 - x_1 - x_2 = 0 \Rightarrow \lambda \neq 0$. Активны ограничения $g_1=0$. Условия К-Т: $x_1 \neq 0, x_2 \neq 0$. $\begin{cases} 2x_1 - 6 - \lambda = 0 \ 2x_2 - 4 - \lambda = 0 \ 5 - x_1 - x_2 = 0 \end{cases}$. Из первых двух уравнений: $2x_1 - 6 = 2x_2 - 4 \Rightarrow 2x_1 - 2x_2 = 2 \Rightarrow x_1 - x_2 = 1$. Используя третье уравнение: $\begin{cases} x_1 - x_2 = 1 \ x_1 + x_2 = 5 \end{cases} \Rightarrow 2x_1 = 6 \Rightarrow x_1 = 3$. Тогда $x_2 = 5 - 3 = 2$. Найдем $\lambda$: $2(3) - 6 - \lambda = 0 \Rightarrow \lambda = 0$. Это дает точку $(3,2)$. Условия К-Т выполнены, но $\lambda = 0$ означает, что ограничение $g_1$ неактивно. Точка **(3,2) подозрительна на максимум**.

    ◦ 7. Внутренняя область ($x_1>0, x_2>0, g_1 > 0$): $g_1 > 0 \Rightarrow \lambda = 0$. $x_1 \neq 0, x_2 \neq 0$. Тогда условия [[Необходимые условия максимума|К-Т]] сводятся к: $\begin{cases} L'_{x_1} = 2x_1 - 6 = 0 \Rightarrow x_1 = 3 \ L'_{x_2} = 2x_2 - 4 = 0 \Rightarrow x_2 = 2 \end{cases}$ Эта точка $(3,2)$ также должна удовлетворять $g_1 > 0$: $5 - 3 - 2 = 0$, что **противоречит** $g_1 > 0$. Значит, во внутренней области нет подозрительных точек.

5. **Геометрическая интерпретация и поиск глобального максимума:** Функция $f(x) = x_1^2 + x_2^2 - 6x_1 - 4x_2$ может быть переписана как: $f(x) = (x_1^2 - 6x_1 + 9) + (x_2^2 - 4x_2 + 4) - 9 - 4$ $f(x) = (x_1 - 3)^2 + (x_2 - 2)^2 - 13$. Задача $f(x) \to \max$ эквивалентна задаче $\text{dist}((x_1,x_2), (3,2))^2 \to \max$. Это означает, что мы ищем точку в допустимой области, наиболее удаленную от центра $(3,2)$. Допустимая область - треугольник с вершинами O(0,0), A(0,5), B(5,0). Центр $(3,2)$ находится внутри этого треугольника.

6. Проверим значения функции в подозрительных точках:

    ◦ $O(0,0): f(0,0) = 0^2 + 0^2 - 6(0) - 4(0) = 0$.

    ◦ $A(0,5): f(0,5) = 0^2 + 5^2 - 6(0) - 4(5) = 25 - 20 = 5$.

    ◦ $B(5,0): f(5,0) = 5^2 + 0^2 - 6(5) - 4(0) = 25 - 30 = -5$.

    ◦ $(0,2): f(0,2) = 0^2 + 2^2 - 6(0) - 4(2) = 4 - 8 = -4$.

    ◦ $(3,0): f(3,0) = 3^2 + 0^2 - 6(3) - 4(0) = 9 - 18 = -9$.

    ◦ $(3,2): f(3,2) = 3^2 + 2^2 - 6(3) - 4(2) = 9 + 4 - 18 - 8 = 13 - 26 = -13$.

7. Сравнивая значения функции в этих точках:

    ◦ $f(O(0,0)) = 0$ (локальный [[Необходимые условия максимума|максимум]]).

    ◦ $f(B(5,0)) = -5$ (не локальный [[Необходимые условия максимума|максимум]]).

    ◦ $f(A(0,5)) = 5$ (локальный [[Необходимые условия максимума|максимум]]).

    ◦ $f((0,2)) = -4$ (не локальный [[Необходимые условия максимума|максимум]]).

    ◦ $f((3,0)) = -9$ (не локальный [[Необходимые условия максимума|максимум]]).

    ◦ $f((3,2)) = -13$ (эта точка является глобальным минимумом функции $f(x)$ без ограничений).

8. Согласно теореме Вейерштрасса, глобальный [[Необходимые условия максимума|максимум]] функции на компактном множестве достигается. Среди найденных подозрительных точек, максимальное значение функции $f(x)$ равно 5, достигается в точке $\textbf{A(0,5)}$. Таким образом, глобальный [[Необходимые условия максимума|максимум]] находится в точке $A(0,5)$.