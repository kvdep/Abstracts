---
aliases:
  - метод Крамера
  - правило Крамера
  - Cramer's rule
---
# Метод Крамера

**Метод Крамера** — это прямой метод решения [[Система линейных алгебраических уравнений|системы линейных алгебраических уравнений (СЛАУ)]], в которой число уравнений равно числу неизвестных. Метод основан на вычислении определителей.

Он применим только в том случае, если определитель основной матрицы системы отличен от нуля. В этом случае система имеет единственное решение.

## Основная идея и формула

Рассмотрим [[Система линейных алгебраических уравнений|СЛАУ]] в матричной форме $Ax = b$, где $A$ — квадратная матрица $n \times n$.

Решение системы находится по **формуле Крамера**:
$$
x_i = \frac{\Delta_i}{\Delta}
$$
где:
*   $\Delta = \det(A)$ — определитель основной матрицы системы.
*   $\Delta_i$ — определитель вспомогательной матрицы $A_i$, которая получается из матрицы $A$ заменой $i$-го столбца на столбец свободных членов $b$.

## Алгоритм

1.  **Шаг 1: Вычислить главный определитель.**
    *   Найти определитель основной матрицы системы $\Delta = \det(A)$.

2.  **Шаг 2: Проверить условие применимости.**
    *   Если $\Delta = 0$, метод Крамера неприменим. Система либо не имеет решений (несовместна), либо имеет бесконечное множество решений (неопределённая).
    *   Если $\Delta \neq 0$, система имеет единственное решение, и можно переходить к следующему шагу.

3.  **Шаг 3: Вычислить вспомогательные определители.**
    *   Для каждой переменной $x_i$ (где $i$ от 1 до $n$) сформировать матрицу $A_i$ и вычислить её определитель $\Delta_i$.

4.  **Шаг 4: Найти решение.**
    *   Вычислить каждую компоненту вектора решений $x$ по формуле $x_i = \frac{\Delta_i}{\Delta}$.

## Сложность и применимость

*   **Сложность:** Вычисление определителя матрицы $n \times n$ методом разложения по строке/столбцу имеет сложность $O(n!)$. Более эффективные методы (например, на основе LU-разложения) снижают её до $O(n^3)$. Тем не менее, для каждой из $n$ переменных нужно вычислить свой определитель, что делает общую сложность высокой.
*   **Применимость:** Из-за высокой вычислительной сложности метод Крамера практически не используется для решения систем с большим числом переменных (обычно $n > 4$). Его основная ценность — в теоретических выкладках и решении систем малого размера вручную. Для практических задач [[Метод Гаусса]] или итерационные методы ([[метод зейделя]], [[Метод релаксации|SOR]]) гораздо эффективнее.

## Пример реализации на Python

```python
import numpy as np

def cramer_method(A, b):
    """
    Реализация метода Крамера для решения СЛАУ Ax = b.

    Args:
        A (np.ndarray): Квадратная матрица коэффициентов (n x n).
        b (np.ndarray): Вектор свободных членов (n x 1).

    Returns:
        np.ndarray: Вектор решения или None, если метод неприменим.
    """
    n = A.shape[0]
    if A.shape[1] != n:
        print("Ошибка: Матрица A должна быть квадратной.")
        return None

    # Шаг 1: Вычислить главный определитель
    det_A = np.linalg.det(A)

    # Шаг 2: Проверить условие
    if np.isclose(det_A, 0):
        print("Ошибка: Определитель основной матрицы равен нулю. Метод Крамера неприменим.")
        return None

    x = np.zeros(n)
    # Шаги 3 и 4: Вычислить вспомогательные определители и найти решение
    for i in range(n):
        A_i = A.copy()
        A_i[:, i] = b  # Заменяем i-й столбец на вектор b
        det_Ai = np.linalg.det(A_i)
        x[i] = det_Ai / det_A

    return x

if __name__ == '__main__':
    # 3x + 2y - z = 1
    # 2x - 2y + 5z = -11
    # -x + y + z = 0
    A = np.array([[3, 2, -1], [2, -2, 5], [-1, 1, 1]], dtype=float)
    b = np.array([1, -11, 0], dtype=float)

    solution = cramer_method(A, b)

    if solution is not None:
        print(f"Решение системы: {solution}")
        # Ожидаемый результат: [ 2. -3. -1.]
        print(f"Проверка A*x: {np.dot(A, solution)}")

```